<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOTEX AI | Inteligencia Inmobiliaria a Medida</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts (Montserrat & Open Sans) -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    // Paleta de Colores Eficaxx
                    colors: {
                        'brand-blue': '#004f8f',
                        'brand-green': '#78ab00',
                        'brand-dark': '#003366',
                        'brand-neutral': '#f2f1f0',
                    },
                    fontFamily: {
                        sans: ['Open Sans', 'sans-serif'],
                        heading: ['Montserrat', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos para asegurar que el contenido de la Landing no se estire */
        body {
            background-color: #f0f2f5; /* Fondo general que se ve en el navegador */
        }
        /* El contenedor principal de la web fuerza el ancho m√≥vil */
        #landing-content {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* Estilos para el Modal de Chat (Asegura que el fondo del chat sea el correcto) */
        #chat-modal-overlay {
            transition: opacity 0.3s ease-in-out;
        }
    </style>
</head>
<body class="font-sans text-gray-800 antialiased">

    <!-- CONTENEDOR PRINCIPAL CENTRADO (SOLUCIONA EL PROBLEMA DE ESTIRAMIENTO) -->
    <div id="landing-content" class="max-w-[480px] mx-auto min-h-screen bg-white relative shadow-2xl">

        <!-- NAVBAR -->
        <nav class="fixed w-[480px] max-w-[480px] z-40 bg-white/95 backdrop-blur-sm shadow-sm border-b border-gray-100 top-0">
            <div class="px-4">
                <div class="flex justify-between items-center h-20">
                    <div class="flex items-center gap-2">
                        <div class="w-8 h-8 bg-brand-green rounded-lg flex items-center justify-center text-white font-bold">L</div>
                        <span class="font-heading font-bold text-2xl text-brand-blue tracking-tight">LOTEX <span class="text-brand-green">AI</span></span>
                    </div>
                    <div class="hidden md:flex space-x-8">
                        <!-- En HTML est√°tico, mejor usar IDs para anclas -->
                        <a href="#problema" class="text-gray-600 hover:text-brand-blue font-semibold transition">El Problema</a>
                        <a href="#solucion" class="text-gray-600 hover:text-brand-blue font-semibold transition">Nuestra Soluci√≥n</a>
                        <a href="#demo" class="text-gray-600 hover:text-brand-blue font-semibold transition">Demo</a>
                    </div>
                    <button onclick="openModal()" class="bg-brand-blue text-white px-4 py-2 rounded-full font-bold hover:bg-brand-dark transition shadow-lg transform hover:scale-105 text-sm">
                        Probar Demo
                    </button>
                </div>
            </div>
        </nav>

        <!-- HERO SECTION (Contenido adaptado al tama√±o de 480px) -->
        <header class="relative pt-24 pb-10 md:pt-32 overflow-hidden">
            <!-- Imagen de Fondo -->
            <div class="absolute inset-0 z-0">
                <img 
                    src="https://e.nexoinmobiliario.pe/customers/eficaxx-grupo-inmobiliario/4027-villa-querencia/lotes-huaral-690e1e30305dd_b.jpg" 
                    alt="Familia feliz en el campo" 
                    class="w-full h-full object-cover object-center" 
                />
                <!-- Overlay Oscuro -->
                <div class="absolute inset-0 bg-black/40"></div>
            </div>

            <!-- Contenido -->
            <div class="relative z-10 container mx-auto px-4 text-center">
                
                <div class="mt-8">
                    <div class="inline-block bg-brand-green/20 text-brand-green px-3 py-1 rounded-full text-xs font-bold mb-4">
                        üöÄ IA que Vende, No que Pregunta
                    </div>
                    <h1 class="font-heading text-4xl font-extrabold text-white leading-tight mb-4 drop-shadow-lg">
                        No te adaptes al software. <span class="text-brand-green block">Que la IA se adapte a ti.</span>
                    </h1>
                    <p class="text-md text-gray-200 mb-8 max-w-xs mx-auto">
                        LOTEX AI: El copiloto comercial entrenado con el flujo de **Valeria** y la visi√≥n de **Villa Querencia**.
                    </p>
                    
                    <!-- CTA Principal -->
                    <button onclick="openModal('general')" class="group bg-brand-green text-white px-8 py-3 rounded-full font-bold shadow-xl hover:shadow-2xl transition-all transform hover:scale-[1.02] flex items-center gap-3 justify-center mx-auto">
                        <i class="fa-brands fa-whatsapp text-xl"></i>
                        Ver Demo en Vivo
                    </button>
                </div>
            </div>
        </header>

        <!-- EL PROBLEMA (VILLANO) VS HEROE -->
        <section id="problema" class="py-12 px-4 bg-white">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-brand-blue mb-2 font-heading">El Villano: Software R√≠gido</h2>
                <p class="text-gray-500 text-sm">Te adaptas a ellos. Nosotros nos adaptamos a tu venta.</p>
            </div>

            <div class="space-y-6">
                <!-- Villano -->
                <div class="bg-gray-100 p-5 rounded-lg border-l-4 border-gray-400">
                    <p class="font-bold text-gray-700 flex items-center gap-2"><i class="fa-solid fa-xmark text-red-400"></i> Software Gen√©rico</p>
                    <p class="text-xs text-gray-500 mt-1">Te obliga a cambiar tus flujos comerciales y de cierre.</p>
                </div>
                <!-- H√©roe -->
                <div className="bg-gradient-to-r from-brand-blue/10 to-white p-5 rounded-lg border-l-4 border-brand-green shadow-md">
                    <p class="font-bold text-brand-blue flex items-center gap-2"><i class="fa-solid fa-check text-brand-green"></i> LOTEX AI</p>
                    <p class="text-xs text-gray-600 mt-1">Entendemos tu proceso y el de Valeria, adaptando la IA a tu forma de vender.</p>
                </div>
            </div>
        </section>

        <!-- CARACTER√çSTICAS -->
        <section id="solucion" class="py-12 px-4 bg-brand-neutral">
            <div class="text-center mb-10">
                <h2 class="text-2xl font-bold text-brand-blue mb-2 font-heading">Inteligencia que Cierra</h2>
                <p class="text-gray-600 text-sm">M√°s all√° de la informaci√≥n, impulsamos la **Trazabilidad y el Cierre**.</p>
            </div>

            <div class="space-y-6">
                <!-- Card 1 -->
                <div class="bg-white p-5 rounded-xl shadow-sm flex gap-4 items-start border-b-2 border-brand-green/50">
                    <div class="w-10 h-10 bg-brand-green/10 rounded-lg flex items-center justify-center text-brand-green mt-1">
                        <i class="fa-solid fa-chart-line"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-brand-blue">Fase de Embudo Clara</h3>
                        <p class="text-gray-600 text-xs">Sabemos si el lead est√° en TOFU (info r√°pida) o BOFU (agenda visita).</p>
                    </div>
                </div>
                <!-- Card 2 -->
                <div class="bg-white p-5 rounded-xl shadow-sm flex gap-4 items-start border-b-2 border-brand-blue/50">
                    <div class="w-10 h-10 bg-brand-blue/10 rounded-lg flex items-center justify-center text-brand-blue mt-1">
                        <i class="fa-solid fa-database"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-brand-blue">Memoria Centralizada (Firebase)</h3>
                        <p class="text-gray-600 text-xs">Todo el chat de Instagram y WhatsApp se guarda en tu CRM para el asesor.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- BLOQUE DE CIERRE: EL BUS -->
        <section class="py-12 px-4 bg-white pb-32">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-brand-blue mb-2 font-heading">
                    El Poder del Cierre: Cita Presencial
                </h2>
                <p class="text-lg text-gray-700 mb-6">
                    El **CTA m√°s fuerte** para un lote es el terreno mismo.
                </p>
            </div>

            <!-- CTA del Bus -->
            <div 
                onclick="openModal('tour')"
                class="rounded-2xl p-6 text-white shadow-xl mb-6 cursor-pointer transform transition active:scale-[0.98] overflow-hidden"
                style="background-color: #004f8f;"
            >
                <div class="flex justify-between items-center">
                    <div>
                        <div class="flex items-center gap-2 mb-2">
                            <Bus className="text-[#78aa00]" />
                            <span class="font-bold uppercase text-xs" style="color: #78aa00;">Cierre BOFU: Visita Guiada</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-1">Bus de Visita</h3>
                        <p class="text-blue-200 text-sm mb-3">Te llevamos a Huaral este domingo. Reserva tu cupo con Valeria.</p>
                        <span class="inline-block bg-white/20 px-3 py-1 rounded text-xs font-semibold">
                            Agendar Viaje &rarr;
                        </span>
                    </div>
                    <div class="text-5xl opacity-50">
                        <MapPin />
                    </div>
                </div>
            </div>

            <p class="text-center text-xs text-gray-500 mt-6">
                La trazabilidad garantiza que el asesor asignado vea todo el historial antes de contactarte.
            </p>
        </section>

        <!-- ==========================================
            STICKY BAR (M√ìVIL)
        =========================================== -->
        <div class="fixed bottom-0 left-0 w-[480px] max-w-[480px] bg-white border-t border-gray-100 p-4 flex items-center justify-between z-40 shadow-[0_-5px_20px_rgba(0,0,0,0.1)]">
            <div>
                <p class="text-[10px] text-gray-500 font-bold uppercase">Precio Preventa</p>
                <p class="text-2xl font-extrabold text-brand-blue">S/ 41,050</p>
            </div>
            <button 
                onclick="openModal('cotizar_sticky')"
                class="bg-brand-green hover:bg-opacity-90 text-white font-bold py-3 px-6 rounded-full shadow-lg flex items-center gap-2 transition active:scale-95"
            >
                <i className="fa-brands fa-whatsapp text-xl"></i>
                <span className="text-sm">Cotizar Ahora</span>
            </button>
        </div>
    </div> <!-- FIN CONTENEDOR PRINCIPAL -->


    <!-- MODAL DE CHAT FLOTANTE (LO √öNICO QUE QUEDA DEL REACT) -->
    <div id="chat-modal-overlay" class="fixed inset-0 z-50 hidden">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal()"></div>
        
        <!-- Contenedor del Chat -->
        <div class="absolute bottom-0 left-0 right-0 mx-auto w-full max-w-[480px] h-[90vh] bg-[#efeae2] rounded-t-[2rem] shadow-2xl flex flex-col relative overflow-hidden animate-in slide-in-from-bottom duration-300">
            
            <!-- Header WhatsApp Style (Color #008069) -->
            <div class="bg-[#008069] px-4 py-4 flex items-center justify-between shadow-md">
                <div class="flex items-center gap-3 text-white">
                    <div class="relative">
                        <img 
                            src="https://e.nexoinmobiliario.pe/customers/eficaxx-grupo-inmobiliario/logo-336-20250912121834.jpg" 
                            alt="Eficaxx" 
                            class="w-10 h-10 rounded-full object-cover border-2 border-white/20"
                        />
                        <div class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-400 rounded-full border border-[#008069]"></div>
                    </div>
                    <div class="flex flex-col">
                        <span class="font-bold text-base leading-tight">Valeria | Villa Querencia</span>
                        <span class="text-xs text-green-100 opacity-90">En l√≠nea ahora</span>
                    </div>
                </div>
                <div class="flex items-center gap-4 text-white">
                    <i class="fa-solid fa-phone w-5 h-5 opacity-80 cursor-not-allowed"></i>
                    <i class="fa-solid fa-xmark w-6 h-6 cursor-pointer opacity-80 hover:opacity-100 rounded-full p-0.5 transition" onclick="closeModal()"></i>
                </div>
            </div>

            <!-- Messages Area (¬°Aqu√≠ va la magia del chat!) -->
            <div 
                id="chat-window"
                class="flex-1 overflow-y-auto p-4 space-y-3 relative"
                style="background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-size: 400px; background-blend-mode: soft-light;"
            >
                <!-- Mensaje Inicial Contextual Autom√°tico -->
                <div id="initial-bot-message" class="flex justify-start animate-in fade-in slide-in-from-left-2 duration-300">
                    <div class="bg-white p-3 rounded-tr-lg rounded-br-lg rounded-bl-lg rounded-tl-none shadow-sm text-sm text-[#111b21] max-w-[85%]">
                        <span class="font-bold text-[#008069] block mb-1 text-xs">Valeria</span>
                        Cargando contexto...
                        <span class="block text-[10px] text-gray-400 text-right mt-1">...</span>
                    </div>
                </div>

                <!-- Aqu√≠ se inyectar√°n din√°micamente los mensajes (Inicialmente vac√≠o) -->
                <div id="messages-container"></div>

                <div id="typing-indicator" class="flex justify-start hidden">
                    <div class="bg-white rounded-lg px-4 py-2 shadow-sm">
                        <div class="flex gap-1">
                            <div class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"></div>
                            <div class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 75ms;"></div>
                            <div class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 150ms;"></div>
                        </div>
                    </div>
                </div>
                <div id="messages-end-ref" />
            </div>

            <!-- Input Area -->
            <div class="bg-[#f0f2f5] p-2 flex items-center gap-2 pb-6 sm:pb-2">
                <div class="bg-white flex-1 rounded-full flex items-center px-4 py-2 shadow-sm border border-gray-200">
                    <input
                        type="text"
                        id="chat-input"
                        placeholder="Escribe un mensaje..."
                        class="w-full bg-transparent border-none focus:outline-none text-gray-700 text-sm"
                    />
                </div>
                <button 
                    id="send-button"
                    class="p-3 rounded-full flex items-center justify-center transition bg-[#008069] text-white hover:scale-105 shadow-md"
                >
                    <i class="fa-solid fa-paper-plane ml-0.5"></i>
                </button>
            </div>

        </div>
    </div>

    <!-- SCRIPTS JAVASCRIPT (Toda la l√≥gica que antes estaba en React) -->
    <script>
        // VARIABLES GLOBALES (Simulando el State de React)
        let isChatOpen = false;
        let messages = [];
        let chatContext = '';
        let isTyping = false;
        const MAX_WIDTH = 480; // Ancho fijo para la landing

        // Elementos del DOM
        const modalOverlay = document.getElementById('chat-modal-overlay');
        const landingContent = document.getElementById('landing-content');
        const chatWindow = document.getElementById('chat-window');
        const messagesContainer = document.getElementById('messages-container');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        const typingIndicator = document.getElementById('typing-indicator');
        const initialBotMessage = document.getElementById('initial-bot-message');

        // --- Funciones de UI/UX ---
        function openModal(context = 'general') {
            chatContext = context;
            isChatOpen = true;
            modalOverlay.classList.remove('hidden');
            document.body.classList.add('overflow-hidden'); // Evitar scroll en el fondo
            
            // Simular mensaje inicial contextual
            simulateInitialBotMessage(context);
            
            // Animaci√≥n de entrada
            setTimeout(() => {
                modalOverlay.style.opacity = 1;
            }, 10);
        }

        function closeModal() {
            isChatOpen = false;
            modalOverlay.style.opacity = 0;
            document.body.classList.remove('overflow-hidden');
            
            // Esperar animaci√≥n
            setTimeout(() => {
                modalOverlay.classList.add('hidden');
                messages = []; // Limpiar mensajes al cerrar
                chatContext = '';
                renderChat();
            }, 300);
        }

        function simulateInitialBotMessage(context) {
            // Usamos un timeout corto para simular que el sistema est√° "preparando" la respuesta
            setTimeout(() => {
                let initialText = "¬°Hola! üëã Bienvenido a Villa Querencia. Soy Valeria. ¬øTe gustar√≠a recibir el plano actualizado y precios?";
                
                if (context === 'tour') {
                    initialText = "¬°Hola! üëã Veo que te interesa la Visita Guiada en Bus. Salimos todos los domingos. ¬øPara cu√°ntas personas te gustar√≠a reservar?";
                } else if (context === 'inversion') {
                    initialText = "¬°Hola! üëã Excelente decisi√≥n pensar en inversi√≥n. Huaral tiene la plusval√≠a m√°s alta por el Puerto. ¬øBuscas comprar al contado o financiado?";
                } else if (context === 'cotizar_sticky') {
                    initialText = "¬°Hola! üëã Te env√≠o la informaci√≥n de precios al instante. ¬øBuscas lote para vivir o para inversi√≥n?";
                }
                
                const botMsg = {
                    id: Date.now().toString(),
                    text: initialText,
                    isUser: false,
                    timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                };
                messages.push(botMsg);
                renderChat();
            }, 500); 
        }

        // --- L√≥gica de Renderizado ---
        function renderChat() {
            messagesContainer.innerHTML = '';
            
            messages.forEach(msg => {
                const msgDiv = document.createElement('div');
                msgDiv.className = `flex w-full ${msg.isUser ? 'justify-end' : 'justify-start'} animate-in fade-in duration-200`;
                
                const bubble = document.createElement('div');
                bubble.className = `relative max-w-[85%] px-3 py-2 rounded-lg text-sm shadow-sm ${
                    msg.isUser 
                    ? 'bg-[#d9fdd3] text-[#111b21] rounded-tr-none' 
                    : 'bg-white text-[#111b21] rounded-tl-none'
                }`;

                const textContent = document.createElement('div');
                textContent.className = 'break-words pb-1';
                textContent.innerText = msg.text;

                const timeStamp = document.createElement('span');
                timeStamp.className = `block text-[10px] text-right mt-1 ${msg.isUser ? 'text-green-800/60' : 'text-gray-400'}`;
                timeStamp.innerText = msg.timestamp;
                if (msg.isUser) {
                    timeStamp.innerHTML += `<i class="fa-solid fa-check-double text-blue-500 ml-1"></i>`;
                }

                bubble.appendChild(textContent);
                bubble.appendChild(timeStamp);
                msgDiv.appendChild(bubble);
                messagesContainer.appendChild(msgDiv);
            });

            // Typing Indicator
            typingIndicator.classList.toggle('hidden', !isTyping);
            
            // Scroll al final
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        // --- L√≥gica de Env√≠o (Simula la llamada a Gemini) ---
        function handleSend() {
            const text = chatInput.value.trim();
            if (!text) return;

            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

            const userMsg = {
                id: Date.now().toString(),
                text: text,
                isUser: true,
                timestamp: timeString,
            };

            messages.push(userMsg);
            chatInput.value = '';
            renderChat();
            
            // 1. Simular que Valeria est√° pensando
            isTyping = true;
            renderChat();

            // 2. Simular llamada a Gemini (Aqu√≠ ir√≠a tu 'sendMessageToGemini(text, 'whatsapp')')
            setTimeout(() => {
                isTyping = false;
                
                // SIMULACI√ìN DE RESPUESTA DE VALERIA (Alineada a la l√≥gica entrenada)
                let simulatedResponse = "Entendido. Gracias por el contexto. Para poder avanzar mejor, ¬øte gustar√≠a que te agende una llamada de 5 minutos o prefieres una videollamada para mostrarte el plan maestro?";

                if (text.toLowerCase().includes("precio") || text.toLowerCase().includes("41000")) {
                    simulatedResponse = "¬°Claro! El precio base es S/ 41,050. Para separar, solo se necesita un monto m√≠nimo. ¬øTienes liquidez para la cuota inicial (20%) o necesitas cr√©dito directo?";
                } else if (text.toLowerCase().includes("visita") || text.toLowerCase().includes("bus")) {
                    simulatedResponse = "¬°Perfecto! Para asegurar tu cupo en el bus de este domingo, necesito confirmar tu nombre completo y tel√©fono. ¬øTe parece si te llamamos en 5 minutos para coordinar la recogida?";
                }

                const botMsg = {
                    id: (Date.now() + 1).toString(),
                    text: simulatedResponse,
                    isUser: false,
                    timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                };

                messages.push(botMsg);
                renderChat();
            }, 2500); // Tiempo simulado de respuesta
        }

        // --- Event Listeners ---
        document.addEventListener('keydown', function(event) {
            if (event.key === "Escape") {
                closeModal();
            }
        });

        sendButton.addEventListener('click', handleSend);
        chatInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                handleSend();
            }
        });

        // Eventos de los CTA de la Landing (¬°La clave!)
        document.querySelectorAll('[data-cta]').forEach(button => {
            button.addEventListener('click', (e) => {
                e.preventDefault();
                const context = button.getAttribute('data-cta');
                openModal(context);
            });
        });

        // Inicializar la vista (debe ser al final)
        window.onload = () => {
            // Asegurar que la vista principal est√© centrada
            landingContent.style.maxWidth = `${MAX_WIDTH}px`;
            landingContent.style.margin = '0 auto';
        }
    </script>
</body>
</html>
